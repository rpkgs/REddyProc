<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>partitionNEEGL — partitionNEEGL • REddyProc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="partitionNEEGL — partitionNEEGL"><meta property="og:description" content="Partition NEE fluxes into GP and Reco using the daytime method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REddyProc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bgctw/REddyProc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>partitionNEEGL</h1>

    <div class="hidden name"><code>partitionNEEGL.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Partition NEE fluxes into GP and Reco using the daytime method.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">partitionNEEGL</span><span class="op">(</span><span class="va">ds</span>, NEEVar <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">NEEVar.s</span><span class="op">)</span><span class="op">)</span> <span class="va">NEEVar.s</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"NEE"</span>, </span>
<span>    <span class="va">suffixDash</span>, <span class="st">"_f"</span><span class="op">)</span>, TempVar <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">TempVar.s</span><span class="op">)</span><span class="op">)</span> <span class="va">TempVar.s</span> <span class="kw">else</span> <span class="st">"Tair_f"</span>, </span>
<span>    VPDVar <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">VPDVar.s</span><span class="op">)</span><span class="op">)</span> <span class="va">VPDVar.s</span> <span class="kw">else</span> <span class="st">"VPD_f"</span>, </span>
<span>    RadVar <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">RadVar.s</span><span class="op">)</span><span class="op">)</span> <span class="va">RadVar.s</span> <span class="kw">else</span> <span class="st">"Rg_f"</span>, </span>
<span>    suffix <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">Suffix.s</span><span class="op">)</span><span class="op">)</span> <span class="va">Suffix.s</span> <span class="kw">else</span> <span class="st">""</span>, </span>
<span>    <span class="va">NEEVar.s</span>, <span class="va">TempVar.s</span>, <span class="va">VPDVar.s</span>, <span class="va">RadVar.s</span>, </span>
<span>    <span class="va">Suffix.s</span>, <span class="va">...</span>, controlGLPart <span class="op">=</span> <span class="fu"><a href="partGLControl.html">partGLControl</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>    isVerbose <span class="op">=</span> <span class="cn">TRUE</span>, nRecInDay <span class="op">=</span> <span class="fl">48L</span>, lrcFitter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/REddyProc/man/RectangularLRCFitter-class.html" class="external-link">RectangularLRCFitter</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-ds">ds<a class="anchor" aria-label="anchor" href="#arg-ds"></a></dt>
<dd><p>dataset with all the specified input columns
and full days in equidistant times</p></dd>

  <dt id="arg-neevar">NEEVar<a class="anchor" aria-label="anchor" href="#arg-neevar"></a></dt>
<dd><p>Variable of NEE</p></dd>

  <dt id="arg-tempvar">TempVar<a class="anchor" aria-label="anchor" href="#arg-tempvar"></a></dt>
<dd><p>Filled air or soil temperature variable (degC)</p></dd>

  <dt id="arg-vpdvar">VPDVar<a class="anchor" aria-label="anchor" href="#arg-vpdvar"></a></dt>
<dd><p>Filled Vapor Pressure Deficit - VPD - (hPa)</p></dd>

  <dt id="arg-radvar">RadVar<a class="anchor" aria-label="anchor" href="#arg-radvar"></a></dt>
<dd><p>Filled radiation variable</p></dd>

  <dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>string inserted into column names before
identifier for NEE column defaults
(see <code><a href="sEddyProc_sMDSGapFillAfterUstar.html">sEddyProc_sMDSGapFillAfterUstar</a></code>).</p></dd>

  <dt id="arg-neevar-s">NEEVar.s<a class="anchor" aria-label="anchor" href="#arg-neevar-s"></a></dt>
<dd><p>deprecated</p></dd>

  <dt id="arg-tempvar-s">TempVar.s<a class="anchor" aria-label="anchor" href="#arg-tempvar-s"></a></dt>
<dd><p>deprecated</p></dd>

  <dt id="arg-vpdvar-s">VPDVar.s<a class="anchor" aria-label="anchor" href="#arg-vpdvar-s"></a></dt>
<dd><p>deprecated</p></dd>

  <dt id="arg-radvar-s">RadVar.s<a class="anchor" aria-label="anchor" href="#arg-radvar-s"></a></dt>
<dd><p>deprecated</p></dd>

  <dt id="arg-suffix-s">Suffix.s<a class="anchor" aria-label="anchor" href="#arg-suffix-s"></a></dt>
<dd><p>deprecated
identifier for NEE column defaults
(see <code><a href="sEddyProc_sMDSGapFillAfterUstar.html">sEddyProc_sMDSGapFillAfterUstar</a></code>).</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments to
<code><a href="partGLExtractStandardData.html">partGLExtractStandardData</a></code>, such as <code>PotRadVar</code></p></dd>

  <dt id="arg-controlglpart">controlGLPart<a class="anchor" aria-label="anchor" href="#arg-controlglpart"></a></dt>
<dd><p>further default parameters,
see <code><a href="partGLControl.html">partGLControl</a></code></p></dd>

  <dt id="arg-isverbose">isVerbose<a class="anchor" aria-label="anchor" href="#arg-isverbose"></a></dt>
<dd><p>set to FALSE to suppress output messages</p></dd>

  <dt id="arg-nrecinday">nRecInDay<a class="anchor" aria-label="anchor" href="#arg-nrecinday"></a></dt>
<dd><p>number of records within one day
(for half-hourly data its 48)</p></dd>

  <dt id="arg-lrcfitter">lrcFitter<a class="anchor" aria-label="anchor" href="#arg-lrcfitter"></a></dt>
<dd><p>R5 class instance
responsible for fitting the light response curve.
Current possibilities are <code><a href="https://rdrr.io/pkg/REddyProc/man/RectangularLRCFitter-class.html" class="external-link">RectangularLRCFitter()</a></code>,
<code><a href="NonrectangularLRCFitter.html">NonrectangularLRCFitter()</a></code>,
and <code><a href="LogisticSigmoidLRCFitter.html">LogisticSigmoidLRCFitter()</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Daytime-based partitioning of measured net ecosystem fluxes into
gross primary production (GPP) and ecosystem respiration (Reco)</p>
<p>The fit to the light-response-curve is done by default using the Rectangular
hyperbolic function, as in Lasslop et al. (2010)
Alternative fittings can be used by providing the corresponding subclass of
<code><a href="LightResponseCurveFitter-class.html">LightResponseCurveFitter-class</a></code> to <code>lrcFitter</code> argument.
(see <code>LightResponseCurveFitter_predictGPP</code>)</p>
<p>While the extrapolation uses filled data, the parameter optimization
may use only measured data, i.e. with specified quality flag.
Even with using filled VPD, there may be large gaps that have not been
filled.
With the common case where VPD is missing for fitting the LRC, by default
(with <code>controlGLPart$isRefitMissingVPDWithNeglectVPDEffect = TRUE</code>)
is to redo the estimation of LRC parameters with neglecting the VPD-effect.
Next, in the predictions (rows) with missing VPD are then replaced
with predictions
based on LRC-fits that neglected the VPD effect.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>Reco_DT_&lt;suffix&gt;</dt>
<dd><p>predicted ecosystem respiration: mumol CO2/m2/s</p></dd>

<dt>GPP_DT_&lt;suffix&gt;</dt>
<dd><p>predicted gross primary production mumol CO2/m2/s</p></dd>

<dt>&lt;LRC&gt;</dt>
<dd><p>Further light response curve (LRC) parameters and
their standard deviation depend on the used LRC
(e.g. for the non-rectangular LRC
see <code><a href="NonrectangularLRCFitter_getParameterNames.html">NonrectangularLRCFitter_getParameterNames</a></code>).
They are estimated for windows and are reported with the first record
of the window</p></dd>

<dt>FP_VARnight</dt>
<dd><p>NEE filtered
for nighttime records (others NA)</p></dd>

<dt>FP_VARday</dt>
<dd><p>NEE filtered for daytime
records (others NA)</p></dd>

<dt>NEW_FP_Temp</dt>
<dd><p>temperature after filtering for quality
flag degree Celsius</p></dd>

<dt>NEW_FP_VPD</dt>
<dd><p>vapour pressure deficit after filtering
for quality flag, hPa</p></dd>

<dt>FP_RRef_Night</dt>
<dd><p>basal respiration estimated
from nighttime (W / m2)</p></dd>

<dt>FP_qc</dt>
<dd><p>quality flag: 0: good parameter fit,
1: some parameters out of range, required refit,
2: next parameter estimate is more than two weeks away</p></dd>

<dt>FP_dRecPar</dt>
<dd><p>records until or after closest record
that has a parameter estimate associated</p></dd>

<dt>FP_errorcode</dt>
<dd><p>information why LRC-fit was not
successful or was rejected, see result of
<code>LightResponseCurveFitter_fitLRC</code></p></dd>

<dt>FP_GPP2000</dt>
<dd><p>predicted GPP at VPD = 0 and PAR = 2000:
a surrogate for maximum photosynthetic capacity</p></dd>

<dt>FP_OPT_VPD</dt>
<dd><p>list object
of fitting results including iOpt and covParms</p></dd>

<dt>FP_OPT_NoVPD</dt>
<dd><p>same as
FP_OPT_VPD holding optimization results with fit
neglecting the VPD effect</p></dd>
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Lasslop G, Reichstein M, Papale D, et al. (2010) Separation of
net ecosystem exchange into assimilation and respiration using
a light response curve approach: critical issues and global evaluation.
Global Change Biology, Volume 16, Issue 1, Pages 187-208</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>partGLFitNightTimeTRespSens</code></p>
<p><code>partGLFitLRCWindows</code></p>
<p><code>partGLInterpolateFluxes</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Wutzler, Markus Reichstein, Antje Maria Moffat, Mirco Migliavacca.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

